

DROP KEYSPACE IF EXISTS users;
DROP KEYSPACE IF EXISTS items;

CREATE KEYSPACE IF NOT EXISTS users
WITH REPLICATION = {'class' : 'SimpleStrategy','replication_factor' : 1};

CREATE KEYSPACE IF NOT EXISTS items
WITH REPLICATION = {'class' : 'SimpleStrategy','replication_factor' : 1};

CREATE TABLE IF NOT EXISTS users.users (
    userId text PRIMARY KEY,
    name text,
    email text
);

CREATE TABLE IF NOT EXISTS items.items (
    itemId text PRIMARY KEY,
    name text,
    info text
);

CREATE TABLE IF NOT EXISTS users.user_by_item (
    itemId text,
    date text,
    userId text,
    name text,
    PRIMARY KEY ((itemId),date,userId)
);

CREATE TABLE IF NOT EXISTS items.item_by_user (
    userId text,
    date text,
    itemId text,
    name text,
    PRIMARY KEY ((userId),date,itemId)
);

insert into users.users (userId,name,email) values ('111', 'bert', 'a@gmail.com');
insert into users.users (userId,name,email) values ('222', 'moose', 'b@gmail.com');
insert into users.users (userId,name,email) values ('333', 'llama', 'c@gmail.com');

insert into items.items (itemId,name,info) values ('aaa', 'Lamp', 'Lights up');
insert into items.items (itemId,name,info) values ('bbb', 'Chair', 'Ass holder');
insert into items.items (itemId,name,info) values ('ccc', 'Bed', 'zzzzzz');

insert into users.user_by_item (itemId,date,userId,name) values ('ccc', '2019-10-01', '111', 'Bed');
insert into users.user_by_item (itemId,date,userId,name) values ('ccc', '2019-10-01', '222', 'Bed');
insert into users.user_by_item (itemId,date,userId,name) values ('bbb', '2019-10-01', '111', 'Chair');
insert into users.user_by_item (itemId,date,userId,name) values ('bbb', '2019-10-01', '333', 'Chair');
insert into users.user_by_item (itemId,date,userId,name) values ('bbb', '2019-09-01', '333', 'Chair');
insert into users.user_by_item (itemId,date,userId,name) values ('bbb', '2020-09-01', '333', 'Chair');
